--- ALL TABLES GO HERE


--- User is working on idea
--- Need Help
--- Another user in his Circle  offer help
--  Request Collaboration as Editor/Contributor ( pending_collaboration
--  Owner of the Work Checks List of Requested Collabolation
--  Either Approves or Rejected Collaboration
--  Once Collaborator is Accepted
--  We keep track of the Collaborator and their Contributions
-- This data is Immutable.
-- Work_Owner can Block a collaborator from Seeing his work.

-- Pending Collaborator
-- Collaborator
-- Contributions ( Who contributed and What was Contributed )

--- User  - User - works 1 - MANY
        -- User --  Work  user can request many works
-- - Works   - > Work - Users 1 - Many Users It can be Owner or Collaborators
    -- Works - Collaborator 1 work can have many collaborators
-- - Collaborator
        -- Users - 1 - Many Collaborator - One user can collaborate on Many Work


-- - Contributions
-- - pending_Collaboration_request
--- Nadas
    -- Each pending collabration request has one  Available NDA
-- Work_Access_record



NEXT WE will add ROW LEVEL SECURITY ON ALL THE TABLES.
 --  Every users can see there work and also the work they are contributing to.
 -- and also they can see there
 -- ================================================================
 -- ROW LEVEL SECURITY AND POLICY IMPLEMENTATION
 -- ================================================================
 -- Purpose:
 -- 1️⃣ Ensure every user sees only their own data in the system.
 -- 2️⃣ Protect sensitive collaboration data like works and pending requests.
 -- 3️⃣ Implement a security "fence" using RLS and custom policies so:
 --      • Users can only see works they own.
 --      • Collaborators can only see their pending requests or requests to works they own.
 --      • Insertions into pending_contribution_requests are restricted to the requesting user.
 -- 4️⃣ Provides a foundation for future policies (e.g., contributions, NDA access, audit logs).

 -- Notes:
 -- • All operations are done under the 'colab_app' role after granting appropriate permissions.
 -- • Policies rely on the session variable `app.current_user_id` to identify the active user.
 -- • DROP POLICY statements are used during testing or to replace old policies with updated rules.
 -- • This setup ensures that superusers bypass RLS, so testing should be done with non-superuser roles.

